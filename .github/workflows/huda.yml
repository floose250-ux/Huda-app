name: HUDA-PRO-DART-SYSTEM-V63
on: [push, workflow_dispatch]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: subosito/flutter-action@v2
        with:
          channel: 'stable'
      
      # 1. إصلاح النظام وصناعة جدران البيت
      - run: |
          rm -rf lib android ios test # تنظيف أي ملفات يدوية مسببة للتعارض
          flutter create . --org com.huda.app.pro --project-name huda_pro --overwrite
      
      # 2. توزيع المهام على ملفات Dart مستقلة (الاحترافية اللي طلبتها)
      - run: |
          mkdir -p lib/screens
          
          # ملف ديوان الأنساب (خاص باهتماماتك في قبائل اليمن والجزيرة)
          cat <<'EOF' > lib/screens/lineage.dart
          import 'package:flutter/material.dart';
          class LineagePage extends StatelessWidget {
            const LineagePage({super.key});
            @override
            Widget build(BuildContext context) => Scaffold(
              backgroundColor: const Color(0xFF000D0D),
              appBar: AppBar(title: const Text('ديوان الأنساب')),
              body: ListView(children: const [
                ListTile(title: Text('قبيلة العوالق', style: TextStyle(color: Colors.amber)), subtitle: Text('تاريخ وأعلام القبيلة')),
                ListTile(title: Text('بنو حارث', style: TextStyle(color: Colors.amber)), subtitle: Text('أصول وأنساب القبيلة')),
              ]),
            );
          }
          EOF

          # ملف المحرمات الموثقة (الإسبال والنميمة)
          cat <<'EOF' > lib/screens/haram.dart
          import 'package:flutter/material.dart';
          class HaramPage extends StatelessWidget {
            const HaramPage({super.key});
            @override
            Widget build(BuildContext context) => Scaffold(
              backgroundColor: const Color(0xFF000D0D),
              appBar: AppBar(title: const Text('تنبيهات شرعية')),
              body: ListView(children: const [
                ExpansionTile(title: Text('الإسبال للرجال', style: TextStyle(color: Colors.redAccent)), children: [Padding(padding: EdgeInsets.all(15), child: Text('قال ﷺ: ما أسفل من الكعبين من الإزار ففي النار (رواه البخاري)'))]),
              ]),
            );
          }
          EOF

      - run: flutter pub get
      - run: flutter build apk --release
      
      - uses: actions/upload-artifact@v4
        with:
          name: HUDA-PRO-FINAL-DART-V63
          path: build/app/outputs/flutter-apk/app-release.apk
